(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{541:function(t,n,s){"use strict";s.r(n);var a={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},o=s(4),c=Object(o.a)(a,function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.slotKey}},[s("h1",{attrs:{id:"aes-rsa-java"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#aes-rsa-java","aria-hidden":"true"}},[t._v("#")]),t._v(" aes-rsa-java")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://viking1726.top/attachment/%E5%BD%92%E6%A1%A3.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("代码和秘钥"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("CryptoAndDecrypt")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Value")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"${keys.clientPublicKey}"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" String clientPublicKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Value")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"${keys.clientPrivateKey}"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" String clientPrivateKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Value")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"${keys.serverPublicKey}"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" String serverPublicKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Value")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"${keys.serverPrivateKey}"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" String serverPrivateKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token comment"}},[t._v("/**\n     * @param encryptkey\n     * @param postData\n     * @Title: decrypt\n     * @Description: 解密\n     * @author: viking\n     * @date: 2018/11/6 上午10:52\n     * @return: com.alibaba.fastjson.JSONObject\n     * @throw:\n     */")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" JSONObject "),s("span",{attrs:{class:"token function"}},[t._v("decrypt")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("String encryptkey"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" String postData"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" Exception "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 验签")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" passSign "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EncryUtil"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("checkDecryptAndSign")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("postData"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                encryptkey"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" clientPublicKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serverPrivateKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("passSign"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token comment"}},[t._v("// 验签通过")]),t._v("\n            String aeskey "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" RSA"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("decrypt")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("encryptkey"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    serverPrivateKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            String data "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" AES"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("decryptFromBase64")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("postData"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    aeskey"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n            JSONObject jsonObj "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" JSONObject"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("parseObject")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jsonObj"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" null"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{attrs:{class:"token comment"}},[t._v("/**\n     * @param params\n     * @Title: crypto\n     * @Description: 加密\n     * @author: viking\n     * @date: 2018/11/6 上午11:00\n     * @return: java.lang.String\n     * @throw:\n     */")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" String "),s("span",{attrs:{class:"token function"}},[t._v("crypto")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TreeMap"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("String"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" params"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" Exception "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 生成RSA签名")]),t._v("\n        String sign "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EncryUtil"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("handleRSA")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" clientPrivateKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        params"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("put")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"sign"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sign"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        String info "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" JSON"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("//随机生成AES密钥")]),t._v("\n        String aesKey "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" RandomUtil"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("getRandom")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token number"}},[t._v("16")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("//AES加密数据")]),t._v("\n        String data "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" AES"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("encryptToBase64")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("info"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aesKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 使用RSA算法将商户自己随机生成的AESkey加密")]),t._v("\n        String encryptkey "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" RSA"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("encrypt")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aesKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serverPublicKey"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        Map"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("String"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" map "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("HashMap")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        map"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("put")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"data"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        map"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("put")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"encryptkey"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encryptkey"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" JSON"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("map"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])])])},[],!1,null,null,null);c.options.__file="aes-rsa-java.md";n.default=c.exports}}]);