(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{545:function(t,n,s){"use strict";s.r(n);var a={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},e=s(4),i=Object(e.a)(a,function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.slotKey}},[s("h1",{attrs:{id:"nginx-ffmpeg-简单的推拉流-ubuntu-18-04"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-ffmpeg-简单的推拉流-ubuntu-18-04","aria-hidden":"true"}},[t._v("#")]),t._v(" nginx ffmpeg 简单的推拉流 ubuntu 18.04")]),t._v(" "),s("h2",{attrs:{id:"效果演示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#效果演示","aria-hidden":"true"}},[t._v("#")]),t._v(" 效果演示")]),t._v(" "),s("p",[s("em",[t._v("电脑端推流 obs")])]),t._v(" "),s("Desktop-Video",{attrs:{src:"https://viking1726.top/attachment/11.mp4",poster:"https://viking1726.top/attachment/11-1.png"}}),t._v(" "),s("p",[s("em",[t._v("手机拉流 vlc")])]),t._v(" "),s("Phone-Video",{attrs:{src:"https://viking1726.top/attachment/12.mp4",poster:"https://viking1726.top/attachment/12-1.png"}}),t._v(" "),s("p",[s("em",[t._v("手机拉流 浏览器（微信内浏览器）")])]),t._v(" "),s("Phone-Video",{attrs:{src:"https://viking1726.top/attachment/14.mp4",poster:"https://viking1726.top/attachment/14-1.png"}}),t._v(" "),s("p",[s("em",[t._v("手机推流")]),s("br"),t._v(" "),s("a",{attrs:{href:"http://www.51livetech.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("易-live 网站连接"),s("OutboundLink")],1),t._v(" "),s("Desktop-Video",{attrs:{src:"https://viking1726.top/attachment/13.mp4",poster:"https://viking1726.top/attachment/13-1.png"}})],1),t._v(" "),s("h2",{attrs:{id:"服务器上nginx和rmtp模块安装部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务器上nginx和rmtp模块安装部分","aria-hidden":"true"}},[t._v("#")]),t._v(" 服务器上nginx和rmtp模块安装部分")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("下载nginx和rtmp模块")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/arut/nginx-rtmp-module",target:"_blank",rel:"noopener noreferrer"}},[t._v("nginx-rtmp-module github主页"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[t._v("wget")]),t._v(" http://nginx.org/download/nginx-1.15.5.tar.gz\n"),s("span",{attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://github.com/arut/nginx-rtmp-module/archive/master.zip\n")])])]),s("hr"),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("zsh")]),t._v(" "),s("p",[t._v("zsh extract 插件 解压直接 x  文件名.任意类型")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://viking1726.top/attachment/6.png",alt:"文件截图",title:"文件截图"}}),t._v(" "),s("img",{attrs:{src:"https://viking1726.top/attachment/7.png",alt:"文件截图",title:"文件截图"}}),t._v(" "),s("img",{attrs:{src:"https://viking1726.top/attachment/8.png",alt:"文件截图",title:"文件截图"}})]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("install")]),t._v(" build-essential libpcre3 libpcre3-dev libssl-dev //这里可以先不执行,等报错了在安装\n"),s("span",{attrs:{class:"token function"}},[t._v("cd")]),t._v(" nginx-1.15.5\n./configure --with-http_ssl_module --add-module"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/master/nginx-rtmp-module-master\n"),s("span",{attrs:{class:"token function"}},[t._v("make")]),t._v("\n"),s("span",{attrs:{class:"token function"}},[t._v("make")]),t._v(" instasll\n"),s("span",{attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://raw.github.com/JasonGiedymin/nginx-init-ubuntu/master/nginx -O /etc/init.d/nginx\n"),s("span",{attrs:{class:"token function"}},[t._v("chmod")]),t._v(" +x /etc/init.d/nginx\n"),s("span",{attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx start\n")])])]),s("p",[s("img",{attrs:{src:"https://viking1726.top/attachment/9.png",alt:"文件截图",title:"文件截图"}})]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("nginx可能默认加入的模块")]),t._v(" "),s("p",[t._v("若有报错加入--without-http_gzip_module，或者考虑下载该模块并加入。")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./configure --with-http_ssl_module --add-module"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/master/nginx-rtmp-module-master --without-http_gzip_module\n")])])]),s("hr"),t._v(" "),s("p",[s("em",[t._v("我的nginx启动有点问题 umask解决")]),t._v(" "),s("img",{attrs:{src:"https://viking1726.top/attachment/10.png",alt:"文件截图",title:"文件截图"}})]),t._v(" "),s("h2",{attrs:{id:"ffmpeg-部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg-部分","aria-hidden":"true"}},[t._v("#")]),t._v(" ffmpeg 部分")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("install")]),t._v(" ffmpeg\n//我这里直接可以安装 所以没有添加源\n//apt-add-repository ppa:jon-severinsson/ffmpeg\n")])])]),s("h2",{attrs:{id:"nginx-conf-部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-conf-部分","aria-hidden":"true"}},[t._v("#")]),t._v(" nginx.conf 部分")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("记得替换ip")]),t._v(" "),s("p",[s("em",[t._v("推流路径 rtmp://your_server_ip:1935/hls")]),s("br"),t._v(" "),s("em",[t._v("拉流路径 rtmp://your_server_ip:1935/hls")])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("http {\n        ...\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        ...\n\n}\nrtmp {\n    server {\n        listen 1935;\n        application hls {\n            live on;\n            record off;\n        }\n    }\n}\n\n")])])]),s("h2",{attrs:{id:"nginx-conf-部分二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-conf-部分二","aria-hidden":"true"}},[t._v("#")]),t._v(" nginx.conf 部分二")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("记得替换ip")]),t._v(" "),s("p",[s("em",[t._v("推流路径 rtmp://YOUR_SERVER_IP:1935/hls")]),s("br"),t._v(" "),s("em",[t._v("拉流路径 http://YOUR_SERVER_IP/hls/index.m3u8")])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("http {\n        ...\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        ...\n        \n    location /hls {  \n                types {  \n                    application/vnd.apple.mpegurl m3u8;  \n                    video/mp2t ts;  \n                }  \n                root /tmp;\n                #alias /tmp/hls;    # root 和 alias任选一种。\n                expires -1;         #指定“Expires”的值为当前服务器时间-1s，即永远过期。 \n                Cache-Control no-cache;  \n    }  \n\n\n}\nrtmp {\n    server {\n        listen 1935;\n        application hls {\n            live on;\n            hls on;                  \n            wait_key on;             #对视频切片进行保护，这样就不会产生马赛克了。\n            hls_path /tmp/hls;       #切片存放位置。\n            hls_fragment 10s;        #切片的时长。\n            hls_playlist_length 60s; #总时长。\n            hls_continuous on;       #连续模式。\n            hls_cleanup on;          #切片清理。\n            hls_nested on;           #嵌套模式。\n        }\n    }\n}\n\n")])])]),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("资料来源")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/muclenerd/article/details/52291598",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/muclenerd/article/details/52291598"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://blog.csdn.net/kingroc/article/details/50839994",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/kingroc/article/details/50839994"),s("OutboundLink")],1)])])],1)},[],!1,null,null,null);i.options.__file="nginx-rtmp.md";n.default=i.exports}}]);